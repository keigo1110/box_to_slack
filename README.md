# ESP32 Document Submission Detector

ESP32とSW-520D傾斜センサーを使用して、書類の提出を検知しSlackに通知するシステムです。

## 概要

書類提出トレイに傾斜センサーを設置し、書類が投函された際の傾きを検知して、Slackワークスペースに通知を送信します。

## 必要なハードウェア

- ESP32開発ボード
- SW-520D 傾斜センサー
- ブレッドボードと配線材

## 必要なライブラリ

- WiFi.h (ESP32標準ライブラリ)
- HTTPClient.h (ESP32標準ライブラリ)
- ArduinoJson.h

## セットアップ手順

1. Arduino IDEに ESP32 ボードマネージャを追加
2. 必要なライブラリをインストール
3. `run.ino`の以下の設定を環境に合わせて変更:
   ```cpp
   const char* ssid = "write your ssid";
   const char* password = "write your password";
   const char* slackWebhookUrl = "write your slack webhook url";
   ```

4. SW-520D傾斜センサーをESP32のGPIO 6に接続

## 主な機能

- デバウンス処理による誤検知防止
- 平均化フィルタによるノイズ除去
- 通知の重複防止（20秒間のインターバル制御）
- WiFi接続の自動リトライ
- Slack通知機能

## ファイル構成

- `run.ino`: メインの実行ファイル
- `notify_slack.ino`: Slack通知機能のテスト用ファイル
- `tilt.ino`: 傾斜センサーの基本的なテストプログラム
- `tilt_re.ino`: リファクタリング済みの傾斜センサープログラム

## 使用方法

1. ハードウェアを接続
2. プログラムをESP32に書き込み
3. シリアルモニタで動作確認（115200bps）
4. トレイに書類が投函されると、Slackに「📄 書類が提出されました！」と通知が送られます

## 開発者向け情報

- デバウンス時間: 500ms
- 通知インターバル: 20秒
- センサー値の平均化サンプル数: 10回

## トラブルシューティング

- WiFi接続エラー時は自動的に再接続を試みます
- シリアルモニタで詳細なログを確認できます
- Slack通知失敗時はエラーコードが表示されます

## 注意事項

- SW-520Dセンサーの取り付け角度により感度が変化する場合があります
- WiFiの電波強度が弱い場所では安定した通知ができない可能性があります
